<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>KARTEJI ‚Ä¢ Karang Taruna Cilosari Barat RT01/RW08</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
<style>
:root{
  --biru:#0e4c92;--emas:#f6c445;--bg:#0b132b;--card:#111928;--text:#e5e7eb;
}
*{box-sizing:border-box;scroll-behavior:smooth}
body{margin:0;font-family:'Poppins',sans-serif;background:var(--bg);color:var(--text);}
header{background:linear-gradient(90deg,var(--biru),#1a6ac2);color:#fff;padding:1rem;display:flex;align-items:center;justify-content:space-between;box-shadow:0 4px 20px rgba(0,0,0,.3)}
.brand{display:flex;align-items:center;gap:.5rem}
.brand img{width:36px;height:36px;filter:drop-shadow(0 0 6px rgba(246,196,69,.6))}
.brand span{font-weight:700;background:linear-gradient(120deg,#0e4c92,#f6c445,#0e4c92);-webkit-background-clip:text;color:transparent;background-size:200%;animation:shine 4s linear infinite}
@keyframes shine{0%{background-position:0%}100%{background-position:200%}}
.container{max-width:1100px;margin:auto;padding:1rem}
.section-title{color:var(--emas);margin:1.2rem 0 .6rem;font-size:1.3rem}
.grid{display:grid;gap:1rem}
.grid-2{grid-template-columns:repeat(auto-fill,minmax(260px,1fr))}
.grid-3{grid-template-columns:repeat(auto-fill,minmax(200px,1fr))}
.card{background:var(--card);border:1px solid rgba(255,255,255,.08);border-radius:12px;padding:1rem;box-shadow:0 4px 20px rgba(0,0,0,.2);transition:.3s}
.card:hover{transform:translateY(-5px);box-shadow:0 6px 24px rgba(246,196,69,.2)}
.btn{display:inline-block;background:var(--emas);color:#0e4c92;border:none;border-radius:8px;padding:.4rem .8rem;font-weight:700;text-decoration:none;transition:.3s}
.btn:hover{background:#ffda5e}
.thumb{width:100%;height:150px;object-fit:cover;border-radius:8px}
.note{opacity:.7;font-size:.9rem}
footer{text-align:center;opacity:.7;padding:1rem;border-top:1px solid rgba(255,255,255,.1);margin-top:2rem}
.modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,.6);justify-content:center;align-items:center;z-index:20}
.box{background:#101826;border:1px solid rgba(255,255,255,.2);border-radius:12px;padding:1.2rem;width:min(90%,420px)}
.box input{width:100%;padding:.6rem;margin:.3rem 0;border-radius:8px;border:1px solid #2b3a55;background:#0d1425;color:#fff}
</style>
</head>
<body>

<header>
  <div class="brand">
    <img src="logo.png" alt="logo">
    <span>KARTEJI</span>
  </div>
  <nav>
    <a href="#pengumuman">Pengumuman</a>
    <a href="#berita">Berita</a>
    <a href="#umkm">UMKM</a>
    <a href="#kas">Kas</a>
    <a id="toDashboard" href="profil.html" style="display:none">Profil</a>
    <a id="openLogin" href="#">Masuk</a>
  </nav>
</header>

<main class="container">
  <section id="pengumuman">
    <h2 class="section-title">üì¢ Pengumuman</h2>
    <div id="pengList" class="grid grid-2"></div>
  </section>

  <section id="berita">
    <h2 class="section-title">üì∞ Berita</h2>
    <div id="beritaList" class="grid grid-3"></div>
  </section>

  <section id="umkm">
    <h2 class="section-title">üè™ Produk UMKM</h2>
    <div id="umkmList" class="grid grid-3"></div>
  </section>

  <section id="kas">
    <h2 class="section-title">üí∞ Ringkasan Kas</h2>
    <div class="card">
      <h3>Total Kas</h3>
      <p id="kasTotal" style="color:var(--emas);font-size:1.5rem;font-weight:700">Rp 0</p>
      <p class="note">Detail transaksi tersedia di Dashboard anggota.</p>
    </div>
  </section>
</main>

<footer>¬© 2025 KARTEJI ‚Ä¢ Karang Taruna Cilosari Barat RT01/RW08</footer>

<!-- Modal Login -->
<div class="modal" id="authModal">
  <div class="box">
    <h3>Masuk / Daftar</h3>
    <input id="email" type="email" placeholder="Email">
    <input id="pass" type="password" placeholder="Kata sandi">
    <button class="btn" id="btnLogin">Masuk</button>
    <button class="btn" id="btnReg">Daftar</button>
    <button class="btn" id="btnReset" style="background:#22314f;color:#fff">Lupa Password?</button>
    <button class="btn" id="btnClose" style="background:#22314f;color:#fff">Tutup</button>
  </div>
</div>

<script type="module" src="js/firebase.js"></script>
<script type="module" src="js/auth.js"></script>

<script>
// === WAIT UNTIL AUTH READY ===
async function waitForAuthAPI(){
  return new Promise(resolve=>{
    const check=()=>{
      if(window.AuthAPI && window.AuthAPI.login) resolve(window.AuthAPI);
      else setTimeout(check,100);
    };
    check();
  });
}

waitForAuthAPI().then((auth)=>{
  console.log("‚úÖ AuthAPI siap:", auth);

  const modal=document.getElementById("authModal");
  document.getElementById("openLogin").onclick=e=>{e.preventDefault();modal.style.display="flex";}
  document.getElementById("btnClose").onclick=()=>modal.style.display="none";
  const email=document.getElementById("email");
  const pass=document.getElementById("pass");

  document.getElementById("btnLogin").onclick=async()=>{
    try{
      await auth.login(email.value.trim(),pass.value);
      modal.style.display="none";
      location.href="profil.html";
    }catch(e){alert(e.message);}
  };
  document.getElementById("btnReg").onclick=async()=>{
    try{
      await auth.register(email.value.trim(),pass.value);
      modal.style.display="none";
      location.href="profil.html";
    }catch(e){alert(e.message);}
  };
  document.getElementById("btnReset").onclick=async()=>{
    if(!email.value.trim())return alert("Isi email dulu");
    try{
      await auth.reset(email.value.trim());
      alert("Link reset dikirim ke email üìß");
    }catch(e){alert(e.message);}
  };
  auth.onAuth(u=>{
    document.getElementById("toDashboard").style.display=u?"inline-block":"none";
  });
});
</script>

</body>
</html>