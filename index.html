<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0" />
<title>Karang Taruna Cilosari Barat RT01/RW08</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet" />
<style>
:root {
  --biru: #0e4c92;
  --emas: #f6c445;
  --gelap: #1e293b;
  --abu: #f7f9fb;
}
* {
  box-sizing: border-box;
}
body {
  margin: 0;
  font-family: 'Poppins', sans-serif;
  background: var(--abu);
  color: var(--gelap);
}
header {
  background: linear-gradient(90deg, var(--biru), #1a6ac2);
  color: #fff;
  padding: 1rem 1.5rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
  flex-wrap: wrap;
}
header h1 {
  font-size: 1.1rem;
  margin: 0;
  font-weight: 700;
}
nav {
  display: flex;
  flex-wrap: wrap;
  gap: 1rem;
}
nav a {
  color: #fff;
  text-decoration: none;
  font-weight: 600;
  transition: 0.2s;
}
nav a:hover {
  color: var(--emas);
}
.hero {
  background: linear-gradient(180deg, var(--biru), #155fa3);
  color: #fff;
  text-align: center;
  padding: 3.5rem 1rem;
}
.hero h2 {
  margin-bottom: 0.5rem;
  font-size: 1.8rem;
}
.hero p {
  max-width: 650px;
  margin: auto;
  line-height: 1.6;
  font-size: 0.95rem;
}
section {
  padding: 2rem 1rem;
}
.container {
  max-width: 1100px;
  margin: auto;
}
h2.section-title {
  color: var(--biru);
  border-left: 5px solid var(--emas);
  padding-left: 0.6rem;
  margin-bottom: 1.5rem;
  font-size: 1.3rem;
}
.grid {
  display: grid;
  gap: 1.2rem;
}
@media(min-width: 768px) {
  .grid-2 {
    grid-template-columns: repeat(2, 1fr);
  }
  .grid-3 {
    grid-template-columns: repeat(3, 1fr);
  }
}
.card {
  background: #fff;
  border-radius: 10px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
  padding: 1rem;
  transition: transform .2s ease;
}
.card:hover {
  transform: translateY(-4px);
}
.card img {
  width: 100%;
  border-radius: 8px;
  margin-bottom: 0.6rem;
  object-fit: cover;
  max-height: 200px;
}
.card h3, .card h4 {
  color: var(--biru);
  margin: 0.4rem 0;
  font-size: 1rem;
}
.card p {
  font-size: 0.9rem;
  line-height: 1.5;
  color: #334155;
}
.btn {
  background: var(--biru);
  color: #fff;
  border: none;
  border-radius: 6px;
  padding: 0.4rem 0.8rem;
  cursor: pointer;
  font-weight: 600;
  display: inline-block;
  text-decoration: none;
  margin-top: 0.4rem;
  transition: 0.2s;
}
.btn:hover {
  background: var(--emas);
  color: var(--biru);
}
footer {
  background: var(--biru);
  color: #fff;
  text-align: center;
  padding: 1rem;
  margin-top: 2rem;
  font-size: 0.9rem;
}
footer .nav-footer {
  margin-bottom: 0.6rem;
}
footer a {
  color: var(--emas);
  text-decoration: none;
  margin: 0 0.5rem;
  font-weight: 600;
}
footer a:hover {
  color: #fff;
}

/* RESPONSIVE FIXES */
@media(max-width:600px){
  header{flex-direction:column;align-items:flex-start;gap:.5rem}
  .hero h2{font-size:1.4rem}
  .card img{max-height:180px}
  nav{gap:.5rem}
}
</style>
</head>
<body>
<header>
  <h1>Karang Taruna Cilosari Barat RT01/RW08</h1>
  <nav>
    <a href="#berita">Berita</a>
    <a href="#umkm">UMKM</a>
    <a href="./admin.html">Admin</a>
  </nav>
</header>

<main>
  <section class="hero">
    <h2>Selamat Datang di Portal Karang Taruna</h2>
    <p>Media informasi kegiatan dan pengembangan UMKM warga Cilosari Barat RT01/RW08, Kelurahan Kemijen, Kecamatan Semarang Timur</p>
  </section>

  <!-- === BERITA === -->
  <section id="berita">
    <div class="container">
      <h2 class="section-title">üì∞ Berita Terkini</h2>
      <div id="beritaList" class="grid grid-2"></div>
    </div>
  </section>

  <!-- === UMKM === -->
  <section id="umkm">
    <div class="container">
      <h2 class="section-title">üè™ UMKM Warga</h2>
      <div id="umkmList" class="grid grid-3"></div>
    </div>
  </section>
</main>

<footer>
  <div class="nav-footer">
    <a href="#berita">Berita</a> |
    <a href="#umkm">UMKM</a> |
    <a href="./admin.html">Admin</a>
  </div>
  <p>&copy; 2025 Karang Taruna Cilosari Barat RT01/RW08 - Semarang Timur</p>
</footer>

<!-- === JS FIREBASE === -->
<script type="module">
import { db } from "./js/firebase.js";
import { collection, query, getDocs, orderBy } 
  from "https://www.gstatic.com/firebasejs/10.14.1/firebase-firestore.js";

const beritaList = document.getElementById("beritaList");
const umkmList = document.getElementById("umkmList");

// ==== BERITA ====
async function loadBerita() {
  try {
    const snap = await getDocs(query(collection(db, "berita"), orderBy("createdAt", "desc")));
    beritaList.innerHTML = "";
    snap.forEach((d) => {
      const b = d.data();
      const isiPendek = (b.isi || "").length > 180 ? b.isi.substring(0, 180) + "..." : b.isi;
      const card = document.createElement("div");
      card.className = "card";
      card.innerHTML = `
        ${b.foto ? `<img src="${b.foto}" alt="${b.judul}">` : ""}
        <h3>${b.judul}</h3>
        <p>${isiPendek}</p>
        <a class="btn" href="berita.html?id=${d.id}">Selengkapnya</a>
      `;
      beritaList.appendChild(card);
    });
  } catch (e) {
    console.error(e);
    beritaList.innerHTML = "<p>Gagal memuat berita.</p>";
  }
}
loadBerita();

// ==== UMKM ====
async function loadUmkm() {
  try {
    const snap = await getDocs(query(collection(db, "umkm"), orderBy("createdAt", "desc")));
    umkmList.innerHTML = "";
    snap.forEach((d) => {
      const u = d.data();
      const card = document.createElement("div");
      card.className = "card";
      card.innerHTML = `
        ${u.foto ? `<img src="${u.foto}" alt="${u.nama}">` : ""}
        <h4>${u.nama}</h4>
        <p>üí∞ Rp${(u.harga || 0).toLocaleString()}</p>
        <p>${u.deskripsi || ""}</p>
        ${u.wa ? `<a href="https://wa.me/${u.wa}" class="btn" target="_blank">Hubungi via WhatsApp</a>` : ""}
      `;
      umkmList.appendChild(card);
    });
  } catch (e) {
    console.error(e);
    umkmList.innerHTML = "<p>Gagal memuat UMKM.</p>";
  }
}
loadUmkm();
</script>
</body>
</html>